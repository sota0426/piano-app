(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[514],{3941:(e,t,l)=>{"use strict";l.r(t),l.d(t,{default:()=>x});var s=l(5155),n=l(1013),a=l(6867),i=l(3776),r=l(2115);let d=e=>{let{isOpen:t,onClose:l,activeHand:n,setActiveHand:a,mode:i,setMode:r,onGoHome:d}=e;return t?(0,s.jsx)("div",{className:"absolute inset-0 bg-black/50 flex items-start justify-center z-50",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg p-6 mt-10 w-full max-w-sm shadow-xl",children:[(0,s.jsx)("h3",{className:"text-lg font-bold mb-6",children:"設定"}),(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("h4",{className:"text-md font-bold mb-2",children:"手のモード"}),(0,s.jsx)("div",{className:"flex gap-2",children:["left","right"].map(e=>(0,s.jsx)("button",{onClick:()=>a(e),className:"px-4 py-2 rounded-lg font-semibold transition-all ".concat(n===e?"bg-blue-500 text-white shadow":"bg-gray-300 text-gray-700 hover:bg-gray-400"),children:"left"===e?"\uD83E\uDD1A 左手":"✋ 右手"},e))})]}),(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("h4",{className:"text-md font-bold mb-2",children:"鍵盤モード"}),(0,s.jsx)("div",{className:"flex gap-2",children:["all","white","black"].map(e=>(0,s.jsx)("button",{onClick:()=>r(e),className:"px-3 py-2 rounded-lg font-semibold transition-all ".concat(i===e?"bg-gray-700 text-white":"bg-gray-300 text-gray-700 hover:bg-gray-400"),children:"all"===e?"全部":"white"===e?"白鍵":"黒鍵"},e))})]}),(0,s.jsxs)("div",{className:"border-t pt-4",children:[(0,s.jsx)("button",{onClick:l,className:"w-full px-4 py-2 bg-gray-200 text-gray-700 rounded hover:bg-gray-300",children:"← ゲームに戻る"}),(0,s.jsx)("button",{onClick:d,className:"mt-2 w-full px-4 py-2 bg-red-100 text-red-600 rounded hover:bg-red-200",children:"ホームに戻る"})]})]})}):null};var c=l(1624);let o=e=>{let{note:t,hand:l}=e,n=r.useRef(null);return r.useEffect(()=>{if(!t||"string"!=typeof t)return void console.warn("SheetMusic: note is invalid:",t);if(!n.current)return;n.current.innerHTML="";let e=new c.A4(n.current,c.A4.Backends.SVG);e.resize(260,140);let s=e.getContext();s.setFont("Arial",12).setBackgroundFillStyle("#f9f9f9");let a=((e,t)=>t?"left"===t?"bass":"treble":3>=parseInt(e.slice(-1),10)?"bass":"treble")(t,l),i=new c.m6(10,20,240);i.addClef(a),i.setContext(s).draw();let r=t[0].toLowerCase(),d=t.includes("#"),o=t.includes("b"),f=t.slice(-1),x="";d&&(x="#"),o&&(x="b");let u="".concat(r).concat(x,"/").concat(f);try{let e=new c._C({clef:a,keys:[u],duration:"q"});d&&e.addModifier(new c.RG("#")),o&&e.addModifier(new c.RG("b")),c.ZA.FormatAndDraw(s,i,[e])}catch(e){console.error("VexFlow rendering error:",e),s.fillText("♪ ".concat(t),100,120),s.fillText("(".concat(a," clef)"),90,140)}},[t,l]),(0,s.jsxs)("div",{className:"flex flex-col items-center w-full justify-center",children:[(0,s.jsx)("div",{className:"flex justify-center items-center w-full",ref:n}),(0,s.jsx)("div",{className:"text-base text-gray-700 mt-2 text-center",children:!l&&(3>=parseInt(t.slice(-1))?"\uD83E\uDD1A 低音域":"✋ 高音域")})]})};var f=l(5695);let x=()=>{let[e,t]=(0,r.useState)("C3"),[l,c]=(0,r.useState)("C4"),[x,u]=(0,r.useState)([]),[h,m]=(0,r.useState)([]),[b,g]=(0,r.useState)(null),[j,y]=(0,r.useState)(null),[v,w]=(0,r.useState)([]),[p,N]=(0,r.useState)([]),[C,k]=(0,r.useState)("all"),[S,A]=(0,r.useState)(!1),[E,M]=(0,r.useState)("right"),[T,_]=(0,r.useState)(!1),{playNote:F}=(0,a.A)(),H=(0,f.useRouter)(),K=e=>{let l=i.V.filter(t=>"left"===e?"left"===t.hand||"both"===t.hand:"right"===t.hand||"both"===t.hand);"white"===C?l=l.filter(e=>"white"===e.type):"black"===C&&(l=l.filter(e=>"black"===e.type));let s=l.map(e=>e.note),n=s[Math.floor(Math.random()*s.length)];"left"===e?(t(n),u([]),g(null),w([])):(c(n),m([]),y(null),N([])),T&&F(n,1.2,.9)},D=t=>{T||_(!0),!1===b&&(u([]),w([]),g(null)),u([t]),F(t,1.2,.8),t===e?g(!0):(g(!1),w(e=>[...e,t]))},P=e=>{T||_(!0),!1===j&&(m([]),N([]),y(null)),m([e]),F(e,1.2,.8),e===l?y(!0):(y(!1),N(t=>[...t,e]))};return(0,r.useEffect)(()=>{if(!0===b){let e=setTimeout(()=>{K("left")},2e3);return()=>clearTimeout(e)}},[b,C]),(0,r.useEffect)(()=>{if(!0===j){let e=setTimeout(()=>{K("right")},2e3);return()=>clearTimeout(e)}},[j,C]),(0,r.useEffect)(()=>{K("left"),K("right")},[]),(0,r.useEffect)(()=>{K("left"),K("right")},[C]),(0,s.jsxs)("div",{className:"min-h-screen flex flex-col bg-gradient-to-br from-indigo-50 to-blue-100 p-4",children:[(0,s.jsxs)("div",{className:"w-full flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6",children:[(0,s.jsx)("h2",{className:"text-3xl font-bold text-gray-800 text-center sm:text-left",children:"\uD83C\uDFBC 音あてクイズ"}),(0,s.jsxs)("div",{className:"flex gap-3 justify-center sm:justify-end",children:[(0,s.jsx)("button",{onClick:()=>A(!0),className:"px-4 py-2 rounded-lg font-semibold text-white bg-indigo-600 hover:bg-indigo-700 shadow",children:"⚙️ 設定"}),(0,s.jsx)("button",{onClick:()=>{T||_(!0),K(E)},className:"px-4 py-2 rounded-lg font-semibold text-white bg-blue-600 hover:bg-blue-700 shadow",children:"\uD83C\uDFB5 次の問題"})]})]}),(0,s.jsxs)("div",{className:"flex-1 flex flex-col",children:[(0,s.jsxs)("div",{className:"flex-1 flex flex-col lg:hidden",children:[(0,s.jsx)("div",{className:"bg-white rounded-xl shadow-lg p-4 mb-4 flex-shrink-0",children:(0,s.jsx)(o,{note:"left"===E?e:l,hand:E})}),(0,s.jsx)("div",{className:"flex justify-center items-center mt-4",children:("left"===E?b:j)!==null&&(0,s.jsx)("div",{className:"text-xl font-bold px-6 py-3 rounded-lg ".concat(("left"===E?b:j)?"text-green-600 bg-green-100":"text-red-600 bg-red-100"),children:("left"===E?b:j)?"\uD83C\uDF89 正解！":"❌ ちがいます"})}),(0,s.jsxs)("div",{className:"flex-1 flex flex-col justify-end min-h-0",children:[(0,s.jsx)("div",{className:"mb-3",children:(0,s.jsx)(n.Ay,{onNoteInput:"left"===E?D:P,enabled:!0,hand:E})}),(0,s.jsx)(i.Ay,{activeKeys:new Set("left"===E?x:h),userAnswer:"left"===E?x:h,disabledKeys:"left"===E?v:p,isPlayingQuiz:!1,onKeyPress:"left"===E?D:P,activeHand:E})]})]}),(0,s.jsxs)("div",{className:"hidden lg:flex flex-1 gap-4",children:[(0,s.jsx)("div",{className:"flex-1 bg-white rounded-xl shadow-lg p-4 min-h-0",children:(0,s.jsx)(o,{note:"left"===E?e:l,hand:E})}),(0,s.jsxs)("div",{className:"flex-[2] flex flex-col justify-center",children:[(0,s.jsx)("div",{className:"mb-3",children:(0,s.jsx)(n.Ay,{onNoteInput:"left"===E?D:P,enabled:!0,hand:E})}),(0,s.jsx)(i.Ay,{activeKeys:new Set("left"===E?x:h),userAnswer:"left"===E?x:h,disabledKeys:"left"===E?v:p,isPlayingQuiz:!1,onKeyPress:"left"===E?D:P,activeHand:E})]})]})]}),(0,s.jsx)(d,{isOpen:S,onClose:()=>A(!1),activeHand:E,setActiveHand:M,mode:C,setMode:k,onGoHome:()=>H.push("/")})]})}},9854:(e,t,l)=>{Promise.resolve().then(l.bind(l,3941))}},e=>{e.O(0,[214,362,987,250,441,964,358],()=>e(e.s=9854)),_N_E=e.O()}]);